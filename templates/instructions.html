{% extends "base.html" %}
{% load static %}
{% block title %}Interview{% endblock %}
{% block head_content %}

    <style type="text/css">
        #video{
            width: 360px;
            height: 200px;
            margin: 10px auto;
            object-fit: cover;
        }
    </style>
{% endblock %}

{% block content %} 

<div class="container-fluid screen-1">
    <h1 class="mt-5">Welcome to Your Virtual Interview</h1>
    <h2>Check Your Audio as Well As Video on this page and Be Ready for your Virtual Interview</h2>
    <h4>On the Next Page, You will have to chooe if you want to attempt the Fresher Interview or the Interview for Professionally Experienced Professionals</h4>
    <h4>Post that, your interview starts where there will be no pauses in between to ensure a real interview like experience</h4>
    <p>Clicking on the Start Interview Button will start your interview with our virtual interviewer Asking you your first question. As the question ends, recording of your answer will start automatically and the same will be prompted on your screen. Speak your answer in the microphone and click on the button for the next question to start and the cycle goes on.</p>
        
    <br>
    <h3>Check Your Video Here</h3>
    <video muted id="video"></video><br>

    <h3><a href="/choice/">Continue</a></h3>
</div>
    <script type="text/javascript">  

        window.onload = function() {
            let checking = ["audioinput", "videoinput"];
            let onlyHas = [];
            navigator.mediaDevices.enumerateDevices()
            .then((devices) => {
                let haveAllDevices = true;
                devices.forEach((device) => {
                    onlyHas.push(device.kind);
                    if (!(device.kind == checking[0] || device.kind == checking[1])) {
                        haveAllDevices = false;
                    }
                });
                
            })
            .catch(function(err) {
                console.log(err.name + ": " + err.message);
            });


            //add constraints object
            var constraints = { audio: true,
                                video: true};
        
            //call getUserMedia, then the magic
            navigator.mediaDevices.getUserMedia(constraints).then(function(mediaStream){
                var video = document.querySelector('video');
                video.srcObject = mediaStream;
                video.play();
            }).catch(function(err){
                if (err.name == "NotAllowedError") {
                    console.log("User has denied accessed")
                 }
            });
        
        }
    </script>

{% endblock %}